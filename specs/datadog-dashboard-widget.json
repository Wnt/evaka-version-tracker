{
    "title": "eVaka Version Monitor",
    "type": "query_table",
    "requests": [
        {
            "queries": [
                {
                    "data_source": "logs",
                    "name": "query1",
                    "search": {
                        "query": "source:evaka-monitor"
                    },
                    "indexes": [
                        "*"
                    ],
                    "compute": {
                        "aggregation": "max",
                        "metric": "@core_age_days"
                    },
                    "group_by": [
                        {
                            "facet": "@instance_name",
                            "limit": 20,
                            "sort": {
                                "aggregation": "max",
                                "metric": "@core_age_days",
                                "order": "desc"
                            }
                        },
                        {
                            "facet": "@custom_commit",
                            "limit": 1,
                            "sort": {
                                "aggregation": "count",
                                "order": "desc"
                            }
                        },
                        {
                            "facet": "@custom_age",
                            "limit": 1,
                            "sort": {
                                "aggregation": "count",
                                "order": "desc"
                            }
                        },
                        {
                            "facet": "@custom_message",
                            "limit": 1,
                            "sort": {
                                "aggregation": "count",
                                "order": "desc"
                            }
                        },
                        {
                            "facet": "@core_commit",
                            "limit": 1,
                            "sort": {
                                "aggregation": "count",
                                "order": "desc"
                            }
                        },
                        {
                            "facet": "@core_age",
                            "limit": 1,
                            "sort": {
                                "aggregation": "count",
                                "order": "desc"
                            }
                        },
                        {
                            "facet": "@core_message",
                            "limit": 1,
                            "sort": {
                                "aggregation": "count",
                                "order": "desc"
                            }
                        }
                    ],
                    "storage": "hot"
                }
            ],
            "response_format": "scalar",
            "formulas": [
                {
                    "alias": "Core Age (days)",
                    "formula": "query1",
                    "conditional_formats": [
                        {
                            "comparator": "<=",
                            "value": 2,
                            "palette": "white_on_green"
                        },
                        {
                            "comparator": "<=",
                            "value": 7,
                            "palette": "white_on_yellow"
                        },
                        {
                            "comparator": ">",
                            "value": 7,
                            "palette": "white_on_red"
                        }
                    ]
                }
            ]
        }
    ],
    "has_search_bar": "auto"
}
